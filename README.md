## [《深入理解 TCP 协议：从原理到实战》](https://s.juejin.cn/ds/DJSYpRU/)

TCP/IP 协议族指的是在 IP 协议通信过程中用到的协议的统称，而非TCP、IP这两种协议


- **应用层**：规定了应用程序之间如何相互传递报文，常见的协议有 HTTP、域名解析协议 DNS和收发邮件的协议 STMP等
- **传输层**：为两台主机之间的 **「应用进程」** 提供**端到端**的逻辑通信，常见的协议有 TCP、UDP协议
- **网络互连层**：**主机到主机的通信**，将传输层产生的的数据包封装成分组数据包发送到目标主机，并提供路由选择的能力。
IP 协议是网络层的主要协议，TCP 和 UDP 都是用 IP 协议作为网络层协议。这一层的主要作用是给包**加上源地址和目标地址**，**将数据包传送到目标地址**
- **网络访问层**：也叫做网络接口层，以太网、Wifi、蓝牙工作在这一层，网络访问层提供了主机连接到物理网络需要的硬件和相关的协议

分层的好处是什么？

1. 各层独立，不需要了解上下层是如何工作的，各层的修改不影响其他层
2. 职责清晰，方便进行标准化

### TCP协议

TCP 是一个**可靠的**（reliable）、**面向连接的**（connection-oriented）、**基于字节流**（byte-stream）的**全双工**（full-duplex）通信协议

可靠性的保证主要有以下几个方面：**校验和**；**包的序列号用来解决数据的乱序和重复**；**超时重传**；**流量控制**；**拥塞控制**

**面向连接**是指在正式发送数据之前需要通过**握手来建立逻辑连接**，而结束通信时，也是**通过有序的四次挥手来断开连接**

基于字节流指的是**没有固定的报文边界**，发送方写入的报文和接收方读取的报文可能不一致，比如说发送方发送500字节和800字节的报文，
而在接收方读取时可能是以1000字节和300字节读取的。这种情况取决于：路径最大传输单元MTU、发送窗口大小和拥塞窗口大小等。

全双工指的是客户端和服务端既可以发送数据也可以接收数据。

### Wireshark 工具

#### 1. 过滤指定域名的包

![img.png](指定域名过滤.png)

执行 `curl http://www.baidu.com`

curl是在命令行下工作的文件传输工具，支持文件的上传和下载

#### 异常解决

安装完成后提示 `The capture session could not be initiated on interface 'en0' (You don't have permission to capture on that device).`

执行 `sudo chmod o+r /dev/bpf*` 修改权限即可
